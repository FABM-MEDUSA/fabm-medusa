check_conservation: true
instances:
  light:
    model: medusa/medusa_light
    coupling:
      ZCHN: pelagic/ZCHN
      ZCHD: pelagic/ZCHD
#  nflux:
#    model: constant_surface_flux
#    use: false
#    parameters:
#      flux: 1.6e-10
#    coupling:
#      target: medusa_pelagic/ZFER
  gas_transfer:
    model: medusa/gas_transfer
    parameters:
      eqn: 7                    #choice of gas transfer coefficients, default = 7
                                # 1 Liss & Merlivat (1986)    [approximated]
                                # 2 Wanninkhof (1992)         [sans enhancement]
                                # 3 Nightingale et al. (2000) [good]
                                # 4 Nightingale et al. (2000) [better]
                                # 5 Nightingale et al. (2000) [best]
                                # 6 OCMIP-2                   [sans variability]
                                # 7 Wanninkhof (2014)         [assumes 6h avg winds]
  carbonate:
    model: medusa/medusa_carbonate
    coupling:
      ZDIC: pelagic/ZDIC
      ZALK: pelagic/ZALK
      kw660: gas_transfer/kw660
  oxygen:
    model: medusa/medusa_oxygen
    coupling:
      ZOXY: pelagic/ZOXY
      kw660: gas_transfer/kw660
  pelagic:
    model: medusa/medusa_pelagic
    parameters:
      xxi: 0.01257              # C:N conversion factor (mol N g C-1), default=0.01257
      xaln: 15.0                # chl-specific initial slope of P-I curve (non-diatoms) (g C(g chl)-1 (W m-2)-1 d-1), default=15.0
      xald: 11.25               # chl-specific initial slope of P-I curve (diatoms) (g C(g chl)-1 (W m-2)-1 d-1), default=11.25
      jliebig: false            # Liebig''s minimum law for nutrient limitation, 'jliebig'), default= false
      xnln: 0.5                 # N nutrient uptake half-saturation constant (non-diatoms) (mmol N m-3), default=0.5	
      xfln: 0.00033             # Fe nutrient uptake half-saturation constant (non-diatoms) (mmol Fe m-3), default=0.00033
      xnld: 0.75                # N nutrient uptake half-saturation constant (non-diatoms) (mmol N m-3), default=0.75
      xsld: 3.0                 # Si nutrient uptake half-saturation constant (diatoms) (mmol Si m-3), default=3.0	
      xfld: 0.00067             # Fe nutrient uptake half-saturation constant (diatoms) (mmol Fe m-3), default=0.00067
      xvpn: 0.53                # Maximum phytoplankton growth rate (non-diatoms) (d-1), default=0.53
      xvpd: 0.50                # Maximum phytoplankton growth rate (diatoms) (d-1), default=0.50
      jphy: 1                   # Temperature regulation (phyto growth), 1-Eppley,2-q10,default=1
      jq10: 1.5                 # q10 factor for temperature regulation option 2, default=1.5
      xsin0: 0.2                # minimum diatom Si:N ratio (mol Si mol N-1), default=0.2
      xnsi0: 0.2                # minimum diatom N:Si ratio (mol N mol Si-1), default=0.2
      xuif: 1.5                 # hypothetical growth ratio at Inf Si:N ratio, default=1.5
      xthetam: 0.05             # maximum Chl:C ratio (non-diatoms) (g chl g C-1), default=0.05
      xthetamd: 0.05            # maximum Chl:C ratio (diatoms) (g chl g C-1), default=0.05
      xkmi: 0.8                 # microzooplankton grazing half-saturation constant (mmol N m-3), default=0.8
      xpmipn: 0.75              # microzooplankton grazing preference on non-diatoms, default=0.75
      xpmid: 0.25               # microzooplankton grazing preference on detritus, default=0.25
      xkme: 0.3                 # mesozooplankton grazing half-saturation constant (mmol N m-3), default=0.3
      xpmepn: 0.15              # mesozooplankton grazing preference on non-diatoms, default=0.15
      xpmepd: 0.35              # mesozooplankton grazing preference on diatoms, default=0.35
      xpmezmi: 0.35             # mesozooplankton grazing preference on microzooplankton, default=0.35
      xpmed: 0.15               # mesozooplankton grazing preference on detritus, default=0.15
      xgmi: 2.0                 # maximum microzooplankton grazing rate (d-1), default=2.0
      xgme: 0.5                 # maximum mesozooplankton grazing rate (d-1), default=0.5	
      xthetad: 6.625            # detritus C:N ratio (mol C mol N-1), default=6.625
      xphi: 0.20                # zooplankton grazing inefficiency, default=0.20
      xthetapn: 6.625           # phytoplankton C:N ratio (non-diatoms) (mol C mol N-1), default=6.625
      xthetapd: 6.625           # phytoplankton C:N ratio (diatoms) (mol C mol N-1), default=6.625
      xbetan: 0.77              # zooplankton N assimilation efficiency, default=0.77
      xthetazmi: 5.625          # microzooplankton C:N ratio (mol C mol N-1), default=5.625	
      xbetac: 0.64              # zooplankton C assimilation efficiency, default=0.64
      xkc: 0.8                  # zooplankton net C growth efficiency, default=0.8
      xthetazme: 5.625          # mesozooplankton C:N ratio (mol C mol N-1), default=5.625
      xmetapn: 0.02             # phytoplankton loss rate (non-diatoms) (d-1), default=0.02
      xmetapd: 0.02             # phytoplankton loss rate (diatoms) (d-1), default=0.02
      xmetazmi: 0.02            # microzooplankton loss rate (d-1), default=0.02
      xmetazme: 0.02            # mesozooplankton loss rate (d-1), default=0.02
      xmpn: 0.1                 # phytoplankton maximum loss rate (non-diatoms) (d-1), default=0.1
      xmpd: 0.1                 # phytoplankton maximum loss rate (diatoms) (d-1), default=0.1
      xmzmi: 0.1                # microzooplankton maximum loss rate (d-1), default=0.1
      xmzme: 0.2                # mesozooplankton maximum loss rate (d-1), default=0.2
      xkphn: 0.5                # phytoplankton loss half-saturation constant (non-diatoms) (mmol N m-3), default=0.5
      xkphd: 0.5                # phytoplankton loss half-saturation constant (diatoms) (mmol N m-3), default=0.5
      xkzmi: 0.5                # microzooplankton loss half-saturation constant (mmol N m-3), default=0.5
      xkzme: 0.75               # mesozooplankton loss half-saturation constant (mmol N m-3), default=0.75
      jmpn: 3                   # mortality formulation (non-diatoms), 1-linear, 2-quadratic, 3-hyperbolic, 4-sigmoid', default=3
      jmpd: 3                   # mortality formulation (diatoms), 1-linear, 2-quadratic, 3-hyperbolic, 4-sigmoid', default=3
      jmzmi: 3                  # mortality formulation (non-diatoms), 1-linear, 2-quadratic, 3-hyperbolic, 4-sigmoid', default=3
      jmzme: 3                  # mortality formulation (non-diatoms), 1-linear, 2-quadratic, 3-hyperbolic, 4-sigmoid', default=3
      jmd: 1                    # Temperature regulation (detritus remin), 1-Eppley,2-q10',default=1
      xmd: 0.0158               # detrital N remineralisation rate (d-1), default=0.0158
      xmdc: 0.0127              # detrital C remineralisation rate (d-1), default=0.0127
      xsdiss: 0.006             # diatom frustule dissolution rate (d-1), default=0.006
      xfdfrac1: 0.33            # fast detritus fraction of diatom losses, default=0.33
      xfdfrac2: 1.              # fast detritus fraction of mesozooplankton losses, default=1.
      xfdfrac3: 0.8             # fast detritus fraction of mesozooplankton grazing, default=0.8
      xrfn: 30.0e-6                # phytoplankton Fe:N uptake ratio (mmol Fe mol N-1 m), default=0.03
      xridg_r0: 0.026           # CaCO3:POC export rain ratio scalar, Ridgwell et al (2007), default=0.026
      xthetanit: 2.0            # O2 consumption by N remineralisation (mol O_2 mol N-1), default=2.0
      xthetarem: 1.1226         # O2 consumption by C remineralisation (mol O_2 mol C-1), default=1.1226
      xo2min: 4.0               # minimum O2 concentration (mmol O_2 m-3), default=4.0
      wg: -2.5                  # detritus sinking rate (m d-1), default = -2.5
    initialization:
      ZCHN: 0.1
      ZCHD: 0.1
      ZPHN: 0.1
      ZPHD: 0.1
      ZPDS: 0.1
      ZDIN: 4.0
      ZFER: 0.001
      ZSIL: 4.0
      ZDET: 0.1
      ZDTC: 0.1
      ZZMI: 0.1
      ZZME: 0.1
      ZALK: 2200.
      ZDIC: 2000.
      ZOXY: 300.
    coupling:
      tempn: fast_detritus/tempn
      tempc: fast_detritus/tempc
      tempsi: fast_detritus/tempsi
      tempfe: fast_detritus/tempfe
      tempca: fast_detritus/tempca
      om_cal: carbonate/Om_cal
  iron_scavenging:
    model: medusa/medusa_iron_scav
    parameters:
      xk_FeL: 100.              # dissociation constant for (Fe+ligand) (mmol m-3)-1, default=0.1
      xLgT: 1.                  # total ligand concentration (mmol m-3), default=0.001	
      xk_sc_Fe: 0.001           # scavenging rate of "free" Fe (d-1), default=0.001
      jiron: 2                  # iron scavenging scheme, 1-Dutkiewicz et al. (2005),2-Moore et al. (2004),3-Moore et al. (2008),4-Galbraith et al. (2010)',default=1
    coupling:
      ZFER: pelagic/ZFER
      ffastc_loc: fast_detritus/ffastc_loc
      fscal_part: pelagic/fscal_part
  fast_detritus:
    model: medusa/medusa_fast_detritus
    parameters:
      iball: 1                 # ballast model formulation (1- ballast model (Yool et al., 2011), 2- ballast-sans-ballast model), default = 1
      seafloor: 3              # seafloor handling (1-inorganic returns, 2-organic returns, 3-couple benthos (nothing to do in this model), default = 1
      xrfn: 30.0e-6               # phytoplankton Fe:N uptake ratio (mmol Fe mol N-1 m), default=0.03
    coupling:
      ZOXY: pelagic/ZOXY
      ZDIN: pelagic/ZDIN
      ZSIL: pelagic/ZSIL
      ZFER: pelagic/ZFER
      ZDIC: pelagic/ZDIC
      ZDET: pelagic/ZDET
      ZDTC: pelagic/ZDTC
      ZALK: pelagic/ZALK
      ZSEDSI: benthic/ZSEDSI
      ZSEDC: benthic/ZSEDC
      ZSEDN: benthic/ZSEDN
      ZSEDCA: benthic/ZSEDCA
      om_cal: carbonate/Om_cal
  benthic:
    model: medusa/medusa_benthic
    use: true
    initialization:
      ZSEDC: 0.
      ZSEDN: 0.
      ZSEDFE: 0.
      ZSEDSI: 0.
      ZSEDCA: 0.
    coupling:
      ZDIN: pelagic/ZDIN
      ZSIL: pelagic/ZSIL
      ZFER: pelagic/ZFER
      ZDIC: pelagic/ZDIC
      ZDET: pelagic/ZDET
      ZDTC: pelagic/ZDTC
      ZOXY: pelagic/ZOXY
      ZALK: pelagic/ZALK
  pco2a:
    model: horizontal_constant
    parameters:
      value: 400.
      standard_name: mole_fraction_of_carbon_dioxide_in_air
